<!doctype html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>兼职平台</title>
    <include file="./Tpl/bootstrap/public/static.html" />
    <style type="text/css">
    .scroll-content {
        position: relative;
    }
    .panel-body {
        position: relative;
    }
    
    .list-group a.list-group-item {
        cursor: pointer;
    }
    
    .btn-content {
        position: absolute;
        right: 10px;
        margin-top: -8px;
    }
    </style>
</head>

<body>
    <include file="./Tpl/bootstrap/public/header_admin.html" />
    <!--container-->
    <div class="container">
        <div class="row">
            <div class="col-md-3">
                <ul class="list-group nav">
                    <a class="list-group-item" href="#publish-apply">兼职申请列表</a>
                    <a class="list-group-item" href="#auth-apply">认证申请列表</a>
                    <a class="list-group-item" href="#current-orgs">现有公司列表</a>
                    <a class="list-group-item" href="#advice">投诉建议</a>
                </ul>
            </div>
            <div class="col-md-9 scroll-content" data-spy="scroll" data-target="#scroll-target">
                <div class="panel panel-primary">
                    <div class="panel-heading" id="publish-apply">兼职申请列表</div>
                    <ul class="list-group">
                    <if condition="is_null($jobs_error)">
                            <volist name="jobs_list" id="list">
                                <li class="list-group-item"><a href="{:U('JobsInfo/index')}?jid={$list.jid}">{$list.title}</a><span class="btn-content" data-jid="{$list.jid}"><button type="button" class="btn btn-success" data-pass="yes">通过</button><button type="button" class="btn btn-danger" data-pass="no">拒绝</button></span></li>
                            </volist>
                            <else/>
                            <li class="list-group-item">{$jobs_error}</li>
                        </if>
                    </ul>
                    <ul class="pagination">{$orgs_page}</ul>
                </div>
                <div class="panel panel-primary">
                    <div class="panel-heading" id="auth-apply">认证申请列表</div>
                    <ul class="list-group">
                        <if condition="is_null($orgsauth_error)">
                            <volist name="orgsauth_list" id="apply">
                                <li class="list-group-item"><a href="{:U('OrgInfo/index')}?oid={$apply.oid}">{$apply.orgname}</a><span class="btn-content" data-oid="{$apply.oid}"><button type="button" class="btn btn-success" data-pass="yes">通过</button><button type="button" class="btn btn-danger" data-pass="no">拒绝</button></span></li>
                            </volist>
                            <else/>
                            <li class="list-group-item">{$orgsauth_error}</li>
                        </if>
                    </ul>
                    <ul class="pagination">{$orgsauth_page}</ul>
                </div>
                <div class="panel panel-primary">
                    <div class="panel-heading" id="current-orgs">现有公司列表</div>
                    <ul class="list-group">
                        <if condition="isset($empty)">
                            <li class="list-group-item">{$empty}</li>
                            <else />
                            <volist name="orgs_list" id="orglists">
                                <a href="{:U('OrgInfo/index')}?oid={$orglists.oid}" class="list-group-item">{$orglists.orgname}/
                                <switch name="orglists.is_validate">
                                <case value="0"><span style="color:#F00">未认证</span></case>
                                <case value="1"><span style="color:#0F0">已认证</span></case>
                                </switch>
                                /创建时间：{$orglists.ctime}</a>
                            </volist>
                        </if>
                    </ul>
                    <nav>
                        <ul class="pagination">{$orgs_page}</ul>
                    </nav>
                </div>
                <div class="panel panel-primary">
                    <div class="panel-heading" id="advice">投诉建议</div>
                    <div class="panel-body">
                        <ul class="list-group">
                        <if condition="$error_advice_info">
                            <li class="list-group-item">{$error_advice_info}</li>
                        <else />
                            <volist name="advice_info" id="info">
                                <a href="{:U("Admin/AdviceDetail")}?ai={$info.advice_id}" target="_blank" class="list-group-item" style="overflow:hidden;height:50px;"><div class="pull-left" style="overflow:hidden;width:400px;">{$info.content|htmlspecialchars_decode}</div><span class="pull-right">{$info.ctime|date='m/d h:i',###}</span></a>
                            </volist>
                        </if>
                        </ul>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        管理地址
                    </div>
                    <div class="panel-body">
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--./container-->
    <!--footer-->
<include file="./Tpl/bootstrap/public/footer.html" />
    <!--./footer-->
    <script>
    $(".btn-content>button").on('click', function() {
        var info = new Object();
        info.pass = $(this).attr('data-pass');
        info.oid = $(this).parent().attr('data-oid');
        info.jid  = $(this).parent().attr('data-jid');
        console.log(info);
        if( info.oid ) {
            $.ajax({
                url: "{:U('Admin/authHandler')}",
                data: info,
                type: "POST",
                success: function(data) {
                    alert(data.info);
                }
            });    
        }else if( info.jid ) {
             $.ajax({
                url : "{:U('Admin/jobHandler')}",
                data: info,
                type: "POST",
                success:function(data) {
                    alert(data.info);
                }
             });   
        }

        
        
    })
    </script>
</body>

</html>
